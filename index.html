<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>2048</title>

<style>
:root{
  --bg:#faf8ef;
  --board:#bbada0;
  --empty:#cdc1b4;
  --text:#776e65;
  --light:#f9f6f2;
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;
  background:var(--bg);
  display:flex;
  justify-content:center;
}

.wrap{width:min(520px,100%);padding:16px}
h1{margin:0;font-size:48px;color:var(--text)}
.header{display:flex;justify-content:space-between;align-items:flex-end}

.scorebox{
  background:var(--board);
  color:var(--light);
  padding:8px 12px;
  border-radius:8px;
  text-align:center;
  min-width:80px;
}
.scorebox small{display:block;font-size:11px;font-weight:700}
.scorebox span{font-weight:800;font-size:18px}

.controls{margin:10px 0;display:flex;gap:10px}
button{
  background:#8f7a66;
  border:none;
  color:white;
  padding:8px 12px;
  border-radius:6px;
  font-weight:700;
}

.board{
  background:var(--board);
  padding:10px;
  border-radius:12px;
  position:relative;
  width:100%;
  aspect-ratio:1/1;
}

.grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  grid-template-rows:repeat(4,1fr);
  gap:10px;
  width:100%;
  height:100%;
}

.cell{
  background:var(--empty);
  border-radius:8px;
}

.tile-layer{
  position:absolute;
  inset:10px;
}

.tile{
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  border-radius:8px;
  transition:transform .12s ease-in-out;
}

.v2{background:#eee4da}
.v4{background:#ede0c8}
.v8{background:#f2b179;color:white}
.v16{background:#f59563;color:white}
.v32{background:#f67c5f;color:white}
.v64{background:#f65e3b;color:white}
.v128{background:#edcf72;color:white}
.v256{background:#edcc61;color:white}
.v512{background:#edc850;color:white}
.v1024{background:#edc53f;color:white}
.v2048{background:#edc22e;color:white}

</style>
</head>
<body>
<div class="wrap">

<div class="header">
<h1>2048</h1>
<div style="display:flex;gap:8px">
<div class="scorebox"><small>SCORE</small><span id="score">0</span></div>
<div class="scorebox"><small>BEST</small><span id="best">0</span></div>
</div>
</div>

<div class="controls">
<button onclick="newGame()">Neu</button>
</div>

<div class="board" id="board">
<div class="grid">
<div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
<div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
<div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
<div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
</div>
<div class="tile-layer" id="tiles"></div>
</div>

</div>

<script>
const size=4;
let board=[],score=0,best=localStorage.best2048||0;
document.getElementById("best").textContent=best;

function newGame(){
board=Array(size).fill().map(()=>Array(size).fill(0));
score=0;
spawn();spawn();
render();
}

function spawn(){
let empty=[];
for(let r=0;r<size;r++)
for(let c=0;c<size;c++)
if(!board[r][c])empty.push([r,c]);
if(!empty.length)return;
let [r,c]=empty[Math.random()*empty.length|0];
board[r][c]=Math.random()<0.9?2:4;
}

function render(){
const layer=document.getElementById("tiles");
layer.innerHTML="";
document.getElementById("score").textContent=score;
if(score>best){best=score;localStorage.best2048=best}
document.getElementById("best").textContent=best;

const cellSize=(layer.clientWidth-30)/4;

for(let r=0;r<size;r++)
for(let c=0;c<size;c++){
let v=board[r][c];
if(v){
let tile=document.createElement("div");
tile.className="tile v"+v;
tile.textContent=v;
tile.style.width=cellSize+"px";
tile.style.height=cellSize+"px";
tile.style.fontSize=cellSize/2.5+"px";
tile.style.transform=`translate(${c*(cellSize+10)}px,${r*(cellSize+10)}px)`;
layer.appendChild(tile);
}
}
}

document.addEventListener("keydown",e=>{
if(e.key==="ArrowLeft")move(0,-1);
if(e.key==="ArrowRight")move(0,1);
if(e.key==="ArrowUp")move(-1,0);
if(e.key==="ArrowDown")move(1,0);
});

let start=null;
document.getElementById("board").addEventListener("touchstart",e=>{
start=[e.touches[0].clientX,e.touches[0].clientY];
});
document.getElementById("board").addEventListener("touchend",e=>{
let dx=e.changedTouches[0].clientX-start[0];
let dy=e.changedTouches[0].clientY-start[1];
if(Math.abs(dx)>Math.abs(dy)){
if(dx>30)move(0,1);
if(dx<-30)move(0,-1);
}else{
if(dy>30)move(1,0);
if(dy<-30)move(-1,0);
}
});

function move(dr,dc){
let moved=false;
let merged=Array(size).fill().map(()=>Array(size).fill(false));

for(let r=(dr>0?size-1:0);r>=0&&r<size;r+=dr>0?-1:1){
for(let c=(dc>0?size-1:0);c>=0&&c<size;c+=dc>0?-1:1){
if(!board[r][c])continue;
let nr=r,nc=c;
while(true){
let tr=nr+dr,tc=nc+dc;
if(tr<0||tr>=size||tc<0||tc>=size)break;
if(!board[tr][tc]){board[tr][tc]=board[nr][nc];board[nr][nc]=0;nr=tr;nc=tc;moved=true;}
else if(board[tr][tc]===board[nr][nc]&&!merged[tr][tc]){
board[tr][tc]*=2;
score+=board[tr][tc];
board[nr][nc]=0;
merged[tr][tc]=true;
moved=true;
break;
}else break;
}
}
}

if(moved){spawn();render();}
}

newGame();
</script>
</body>
</html>
